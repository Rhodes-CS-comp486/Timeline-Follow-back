<!DOCTYPE html>
<html lang="en">
<head>
     <!-- this is all for formatting the webpage
    it adds title to url, fonts from google api and css file
    the css files and api calls are generated with the help of codex-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Timeline Calendar</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@500;600;700&family=Source+Sans+3:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>
<body>
    <div id="app"></div>

    <template id="base-layout">
        <div class="app-shell">
            <nav class="top-nav" aria-label="Primary">
                <a class="nav-btn" href="{{ url_for('home') }}">Home</a>
                <a class="nav-btn" href="{{ url_for('instructions.gambling_instructions') }}">Gambling Instructions</a>
                <a class="nav-btn" href="{{ url_for('instructions.alcohol_instructions') }}">Alcohol Instructions</a>
                <a class="nav-btn is-active" href="{{ url_for('calendar') }}">Calendar</a>
                <a class="nav-btn" href="#">Dashboard</a>
                <a class="nav-btn" href="#">Settings</a>
                <!-- Logout keeps the same nav styling and routes to the sign-out endpoint. -->
                <a class="nav-btn" href="{{ url_for('auth.logout') }}">Logout</a>
            </nav>

            <main class="app-main">
                <aside class="sidebar">
                    <div class="panel">
                        <div class="panel-title" id="selectedDateLabel">Pick a day</div>
                        <div class="entry-summary" id="entrySummary">
                            <p class="entry-empty">Select a date to view its entry.</p>
                        </div>
                        <div class="marker-legend" aria-label="Marker legend">
                            <div class="legend-title">Marker Legend</div>
                            <div class="legend-item">
                                <span class="activity-marker marker-drinking"></span>
                                <span>Drinking</span>
                            </div>
                            <div class="legend-item">
                                <span class="activity-marker marker-gambling"></span>
                                <span>Gambling</span>
                            </div>
                        </div>
                    </div>
                </aside>

                <section class="calendar-area">
                    <div class="calendar-card">
                        <div class="calendar-toolbar">
                            <div class="month-controls">
                                <button class="icon-btn" id="prevMonth" type="button" aria-label="Previous month">&larr;</button>
                                <div class="month-label" id="monthLabel" aria-live="polite"></div>
                                <button class="icon-btn" id="nextMonth" type="button" aria-label="Next month">&rarr;</button>
                            </div>
                        </div>

                        <div class="weekday-row">
                            <span>Sun</span><span>Mon</span><span>Tue</span><span>Wed</span><span>Thu</span><span>Fri</span><span>Sat</span>
                        </div>
                        <div class="calendar-grid" id="calendarGrid"></div>
                    </div>
                </section>
            </main>
        </div>

        <!-- This is the popup window to log events -->
        <div id="eventModal" class="modal-overlay" style="display: none;">
            <div class="modal-content">
                <div class="panel-title" id="modalDateTitle">Log Activity</div>

                <form id="activityForm">
                    <div class="category-toggles">
                        <label>
                            <input type="checkbox" id="chkDrinking"> Did you drink alcohol today?
                        </label>
                        <label>
                            <input type="checkbox" id="chkGambling"> Did you gamble today?
                        </label>
                    </div>

                    <hr style="margin: 15px 0; border: 0; border-top: 1px solid #eee;">

                    <div id="drinkingSection">
                    {% for q in questions.drinking %}
                        <div class="form-group">
                            <label for="{{ q.id }}">{{ q.label }}</label>
                            <input
                                type="{{ q.type }}"
                                id="{{ q.id }}"
                                name="{{ q.id }}"
                                placeholder="{{ q.placeholder }}"
                                {% if q.type == "number" %}step="any"{% endif %}
                                class="modal-input">
                        </div>
                    {% endfor %}
                    </div>

                    <div id="gamblingSection">
                        {% for q in questions.gambling %}
                            <div class="form-group">
                                <label for="{{ q.id }}">{{ q.label }}</label>
                                <input
                                    type="{{ q.type }}"
                                    id="{{ q.id }}"
                                    name="{{ q.id }}"
                                    placeholder="{{ q.placeholder }}"
                                    {% if q.type == "number" %}step="any"{% endif %}
                                    class="modal-input">
                            </div>
                        {% endfor %}
                    </div>


                    <p class="modal-mode-text" id="modalModeText"></p>
                    <div class="modal-actions">
                        <button type="button" class="nav-btn" id="closeModal">Cancel</button>
                        <button type="button" class="nav-btn" id="deleteEntryBtn" style="display: none;">Delete Entry</button>
                        <button type="submit" class="nav-btn is-active" id="saveEntryBtn">Save Entry</button>
                    </div>
                </form>
            </div>
        </div>
    </template>

    <template id="calendar-page"></template>

    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>
